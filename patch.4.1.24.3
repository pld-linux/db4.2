*** os_win32/os_rename.c.orig	2002/07/12 18:56:55	1.12
--- os_win32/os_rename.c	2002/09/25 04:15:41	1.13
***************
*** 24,30 ****
  	u_int32_t flags;
  {
  	int ret;
- 	char oldbuf[MAX_PATH], newbuf[MAX_PATH];
  
  	ret = 0;
  	if (DB_GLOBAL(j_rename) != NULL) {
--- 24,29 ----
***************
*** 45,65 ****
  		} else {
  			/*
  			 * There is no MoveFileEx for Win9x/Me, so we have to
! 			 * do the best we can.
  			 */
- 			if (!GetLongPathName(oldname, oldbuf, sizeof oldbuf) ||
- 			    !GetLongPathName(newname, newbuf, sizeof newbuf)) {
- 				ret = __os_win32_errno();
- 				goto done;
- 			}
- 
- 			/*
- 			 * If the old and new names differ only in case, we're
- 			 * done.
- 			 */
- 			if (strcasecmp(oldbuf, newbuf) == 0)
- 				goto done;
- 
  			(void)DeleteFile(newname);
  			if (!MoveFile(oldname, newname))
  				ret = __os_win32_errno();
--- 44,53 ----
  		} else {
  			/*
  			 * There is no MoveFileEx for Win9x/Me, so we have to
! 			 * do the best we can.  Note that MoveFile returns 1
! 			 * if the names refer to the same file, so we don't
! 			 * need to check that here.
  			 */
  			(void)DeleteFile(newname);
  			if (!MoveFile(oldname, newname))
  				ret = __os_win32_errno();
