*** db/db_open.c.orig	2002/10/11 20:20:13	11.216
--- db/db_open.c	2002/10/16 19:57:26
***************
*** 536,546 ****
  	 * and even a checksum error isn't a reason to panic the environment.
  	 */
  	if ((ret = __db_chk_meta(dbenv, dbp, meta, do_metachk)) != 0) {
! 		if (ret == -1) {
  			__db_err(dbenv,
  			    "%s: metadata page checksum error", name);
- 			ret = EINVAL;
- 		}
  		goto bad_format;
  	}
  
--- 536,544 ----
  	 * and even a checksum error isn't a reason to panic the environment.
  	 */
  	if ((ret = __db_chk_meta(dbenv, dbp, meta, do_metachk)) != 0) {
! 		if (ret == -1)
  			__db_err(dbenv,
  			    "%s: metadata page checksum error", name);
  		goto bad_format;
  	}
  
***************
*** 577,583 ****
  
  bad_format:
  	__db_err(dbenv, "%s: unexpected file type or format", name);
! 	return (ret);
  }
  
  /*
--- 575,581 ----
  
  bad_format:
  	__db_err(dbenv, "%s: unexpected file type or format", name);
! 	return (ret == 0 ? EINVAL : ret);
  }
  
  /*
